window.main=window.main||{},window.main.product=Backbone.View.extend({el:"#main",tmpUrl:"../static/templates/item.ejs",apiUrl:"/api/items/:itemId",initialize:function(t){$.get(this.tmpUrl,_.bind(this.readTemplate,this));var i=this.apiUrl.replace(":itemId",t);$.get(i,_.bind(this.getProduct,this)).fail(_.bind(this.getParams,this))},readTemplate:function(t){this.template=_.template(t),this.render()},getProduct:function(t){console.log(t);var i=t.products.items,e="new"===i.condition?"Nuevo":"Usado",r=1===i.sold_quantity?" vendido":" vendidos",s="ARS"===i.price.currency?"":i.price.currency,n=i.price.amount.toString(),c=i.price.decimal,a=i.price.decimal.toString();this.product={conditionAndSoldQuantity:e+" - "+i.sold_quantity.toString()+r,title:i.title,permalink:i.permalink,picture:i.pictures[0].source||"http://static.mlstatic.com/org-img/preview/MLA/artsinfoto.gif",description:i.description,price:s+"$ "+n,decimals:c<10?"0"+a:a},this.categories=i.categories,this.render()},getParams:function(){this.categories=null,this.product=null,this.render()},render:function(){var t;t=this.template({categories:this.categories,item:this.product}),this.$el.html(t)}}),window.main.products=Backbone.View.extend({el:"#main",tmpUrl:"./static/templates/items.ejs",apiUrl:"/api/items?search=:query",initialize:function(t){$.get(this.tmpUrl,_.bind(this.readTemplate,this));var i=this.apiUrl.replace(":query",t);$.get(i,_.bind(this.getProducts,this)).fail(_.bind(this.getParams,this))},readTemplate:function(t){this.template=_.template(t),this.render()},getProducts:function(t){console.log(t),this.categories=t.search.categories[0].values,this.products=t.search.items.map(function(t){var i="ARS"===t.price.currency?"":t.price.currency,e=t.price.decimal,r=t.price.decimal.toString();return{id:t.id,title:t.title,condition:t.condition,permalink:t.permalink,price:i+"$ "+t.price.amount.toString(),decimals:e<10?"0"+r:r,free_shipping:t.free_shiping,state:t.state,pictures:t.pictures[0].source,description:t.description}}),console.log(this.products),this.render()},getParams:function(){this.categories=null,this.products=[],this.render()},render:function(){var t;t=this.template({categories:this.categories[0].path_from_root,results:this.products}),this.$el.html(t)}});